-- vim:set ft=lua:

require("L4");

local l4lx_vbus = L4.default_loader:new_channel();

L4.default_loader:start(
    { caps = { l4lx   = l4lx_vbus:svr(),

               icu    = L4.Env.icu,
               sigma0 = L4.cast(L4.Proto.Factory, L4.Env.sigma0):create(L4.Proto.Sigma0),
             },
             log      = { "IO", "blue" },
	         l4re_dbg = L4.Dbg.Warn,
    }, "rom/io -vvv rom/arm-sheevaplug.io");

L4.default_loader:start(
    { caps = { log  = L4.Env.log:m("rws"),
               vbus = l4lx_vbus,
             },
             l4re_dbg = L4.Dbg.Warn,
             log = { "l4linux", "yellow" },
    }, "rom/vmlinuz_0.arm mem=64M console=ttyLv0 l4x_rd=rom/ramdisk-mgmt.rd root=1:0 ramdisk_size=8000 rw ");
